Нужно написать консольную программу на языке C++17/20. Программа должна сканировать указанные в параметрах каталоги и файлы, а также выводить результаты сканирования на консоль. Требования к заданию:
Для каждого из найденных файлов необходимо определить формат, а также собрать дополнительную информацию:

Для текстового документа и XML документа нужно определить кодировку. Обязательно должны поддерживаться документы без BOM.

Для PE файлов нужно определить разрядность, архитектуру и наличие managed заголовка (см. IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR).

Для ELF файлов нужно определить разрядность, архитектуру, порядок байт и интерпретатор (см. PT_INTERP) при наличии. fat-формат поддерживать не нужно.

Для Mach-O файлов нужно определить, разрядность, архитектуру, порядок байт, и наличие подписи (см. LC_CODE_SIGNATURE). Нужно также поддержать fat-формат.

По желанию можно добавить ещё несколько форматов на ваше усмотрение

По окончании работы программа должна вывести суммарную информацию о проделанной работе: количество найденных файлов с уникальной комбинацией формата и дополнительной информации. Например (вы вправе всё тут поменять):

75 - ELF, 64-BE, s390, /lib/ld-musl-s390x.so.1

13 - Mach-O, FAT, 64-BE, 2, {64-LE, x64, signed}, {64-LE, ARM64, unsigned}

34 - Mach-O, 32-BE, PPC, signed

93 - PE, 64-LE, ARM64, managed

726 - Text, no-BOM, utf-32-BE

63 - XML, iso-8859-1

672 - Unknown

Программа должна корректно обрабатывать прерывание (окончание) работы через Ctrl+C, с последующим выводом текущей суммарной информации о проделанной работе.

Программа должна выполнять необходимые операции асинхронно.

Количество одновременно обрабатываемых файлов должно быть по умолчанию ограничено количеством ядер процессора или задано через аргумент командной строки.

Использование любых не стандартных библиотек запрещено.

Требуются функциональные тесты. Желательны тесты на производительность.

Программа должна работать под Windows 10+ и Ubuntu 20.04+/macOS 11+

Программ должна поддерживать Unicode для имен входных файлов и не зависеть от установленной в ОС кодировки по умолчанию.